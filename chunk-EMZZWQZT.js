import{a as ie}from"./chunk-5ENT4XQA.js";import{a as ae}from"./chunk-3VYHKAG4.js";import{a as V}from"./chunk-SOWNCCG4.js";import{b as $,m as P}from"./chunk-DYQSPWX7.js";import{$a as r,$b as U,Aa as c,Ac as X,Ba as g,Bb as B,Bc as Y,Cc as Z,Db as R,Ga as O,Ic as ee,Mc as te,Oa as I,Qa as y,T as A,Wa as D,Xa as q,Y as W,Ya as S,Za as x,_a as a,ab as p,ba as E,eb as _,fc as z,gb as b,hb as T,ja as f,ka as v,rb as k,rc as J,sb as o,tb as F,ub as w,vc as K,wa as N,xb as H,yb as j,yc as G,zb as L,zc as Q}from"./chunk-FCI7FGJ6.js";var me=(l,s)=>s.id;function de(l,s){if(l&1&&p(0,"div",12),l&2){let m=s.$implicit;y("innerHtml",m,N)}}function ce(l,s){l&1&&(a(0,"div",13),p(1,"img",41),a(2,"div",42),o(3,"Please Select Template"),r()())}function pe(l,s){if(l&1){let m=_();a(0,"div",43),b("click",function(){let t=f(m).$implicit,i=T();return v(i.selectTemplate(t))}),o(1),r()}if(l&2){let m=s.$implicit;y("innerHtml",m.adminTemplateHtml,N),c(),w(" ",m.adminTemaplateHtml," ")}}var Se=(()=>{let s=class s{constructor(e,t,i,n,u){this.sanitizer=e,this.renderer=t,this.commonService=i,this.storyBuilderService=n,this.route=u,this.builderPage=[],this.templateJson=[]}ngOnInit(){let e=this.route.snapshot.queryParamMap.get("pageId");e&&(this.pageId=Number(e),this.getWebBuildData(this.pageId));let t=this.renderer.createElement("script");t.src=ie.webUrl+"/common.js",this.renderer.appendChild(document.head,t),this.getTemplateList()}selectTemplate(e){var t={templateId:e.id,pageId:this.pageId,sequenceNo:this.builderPage?.length+1,formDetails:e.formDetails};this.storyBuilderService.mappedTemplate(t).subscribe({next:i=>{if(i!=null){if(i.success){console.log(e.webTemplateHtml,"asdfjskfdkl"),e.webTemplateHtml=e.webTemplateHtml?.replace("##templateId##",e.id);var n=this.sanitizer.bypassSecurityTrustHtml(e.webTemplateHtml);this.builderPage.push(n)}this.getWebBuildData(this.pageId),this.commonService.successMessage(i.message)}else this.commonService.errorMessage(i.message)}})}publishedHtml(){let e="";for(let n=0;n<this.builderPage.length;n++){var t=this.builderPage[n].changingThisBreaksApplicationSecurity;e+=t}var i={pageId:this.pageId,pageHtml:e};console.log(i),this.storyBuilderService.publishedHtmlData(i).subscribe({next:n=>{n!=null?n.success&&this.commonService.successMessage(n.message):this.commonService.errorMessage(n.message)}})}getTemplateList(){this.storyBuilderService.list().subscribe({next:e=>{e!=null?e.success&&(this.templateJson=e.response):this.commonService.errorMessage(e.message)}})}getWebBuildData(e){this.builderPage=[],this.storyBuilderService.getPageTemplateMappingData(e).subscribe({next:t=>{if(t!=null){if(t.success)for(let h=0;h<t.response.length;h++){var i=t.response[h].webTemplateHtml;for(let M=0;M<t.response[h].formDetails.length;M++){var n=t.response[h].formDetails[M].elementReplaceValue,u=t.response[h].formDetails[M].elementValue;i=i.replaceAll(n,u)}i=i?.replace("##pageTemplateId##",t.response[h].pageTemplateId);var d=this.sanitizer.bypassSecurityTrustHtml(i);this.builderPage.push(d)}}else this.commonService.errorMessage(t.message)}})}addOrUpdatePageForm(){debugger;var e=document.getElementById("pageTemplateId").value;this.storyBuilderService.editDataFromPageTemplate(Number(e)).subscribe({next:t=>{if(t!=null){if(t.success){debugger;var i=t.response.formDetails;for(let n=0;n<i.length;n++)i[n].elementType=="text"&&(i[n].elementValue=document.getElementById(i[n].elementName).value),i[n].elementType=="editor"&&(i[n].elementValue=document.getElementById("text-editor-container-"+i[n].elementName).value),i[n].elementType=="img"&&(i[n].elementValue=document.getElementById(i[n].elementName).src);this.pageTemplateDataUpdate(Number(e),i)}}else this.commonService.errorMessage(t.message)}})}pageTemplateDataUpdate(e,t){var i={id:e,formDetails:t};this.storyBuilderService.updatePageTemplateData(i).subscribe({next:n=>{n!=null?n.success&&(this.commonService.successMessage(n.message),this.getWebBuildData(this.pageId)):this.commonService.errorMessage(n.message)}})}removePageTemplate(){var e=document.getElementById("pageTemplateId").value;this.storyBuilderService.removePageTemplateData(Number(e)).subscribe({next:t=>{t!=null?t.success&&(this.getWebBuildData(this.pageId),this.commonService.successMessage(t.message)):this.commonService.errorMessage(t.message)}})}RefreshPageTemplate(){this.getWebBuildData(this.pageId)}};s.\u0275fac=function(t){return new(t||s)(g(J),g(O),g(P),g(ae),g(V))},s.\u0275cmp=E({type:s,selectors:[["app-stories-builder"]],standalone:!0,features:[B],decls:64,vars:1,consts:[[1,"navbar","bg-body-tertiary","shadow-sm","sticky-top"],[1,"container-fluid"],["routerLink","/dashboard",1,"text-decoration-none"],[1,"text-muted","text-decoration-none"],["type","button",1,"btn","common-btn",3,"click"],["type","button",1,"btn","common-btn","mx-2",3,"click"],[1,"bi","bi-arrow-clockwise"],["type","button","data-bs-toggle","offcanvas","data-bs-target","#offcanvasRightTemplate","aria-controls","offcanvasRight",1,"btn","common-btn"],[1,"container-fluid","my-3"],[1,"row"],[1,"col-md-12"],[1,"container-fluid","mt-2"],[3,"innerHtml"],[1,"text-center"],["tabindex","-1",1,"modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary"],["id","modelOpenBtn","type","button","data-bs-toggle","offcanvas","data-bs-target","#staticBackdrop","aria-controls","staticBackdrop",1,"btn","btn-primary","d-none"],["data-bs-backdrop","static","tabindex","-1","id","staticBackdrop","aria-labelledby","staticBackdropLabel",1,"offcanvas","offcanvas-end",2,"width","700px"],[1,"offcanvas-header"],["id","offcanvasRightLabel",1,"offcanvas-title"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn-close"],[1,"offcanvas-body"],["id","formBody"],[1,"d-flex","justify-content-between","mt-3"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn","btn-sm","btn-secondary","me-2"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn","btn-sm","btn-primary",3,"click"],["data-bs-backdrop","static","tabindex","-1","id","offcanvasRightTemplate","aria-labelledby","offcanvasRightLabel",1,"offcanvas","offcanvas-end",2,"width","700px"],[1,"offcanvas-header","common-header"],[1,""],[1,"row","g-2","p-2"],["data-bs-dismiss","offcanvas","aria-label","Close","type","button",1,"col-md-12",3,"innerHtml"],["src","assets/no data.jpg","width","500px",1,"img-fluid"],[1,"fw-bold","fst-italic"],["data-bs-dismiss","offcanvas","aria-label","Close","type","button",1,"col-md-12",3,"click","innerHtml"]],template:function(t,i){t&1&&(a(0,"nav",0)(1,"div",1)(2,"div")(3,"a",2),o(4,"Dashboard / "),r(),a(5,"a",3),o(6,"Page-Builder"),r()(),a(7,"div")(8,"button",4),b("click",function(){return i.publishedHtml()}),o(9,"Published"),r(),a(10,"button",5),b("click",function(){return i.RefreshPageTemplate()}),p(11,"i",6),r(),a(12,"button",7),o(13,"Template Block"),r()()()(),a(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11),S(18,de,1,1,"div",12,q),I(20,ce,4,0,"div",13),r()()()(),a(21,"div",14)(22,"div",15)(23,"div",16)(24,"div",17)(25,"h5",18),o(26,"Modal title"),r(),p(27,"button",19),r(),a(28,"div",20)(29,"p"),o(30,"Modal body text goes here."),r()(),a(31,"div",21)(32,"button",22),o(33,"Close"),r(),a(34,"button",23),o(35,"Save changes"),r()()()()(),a(36,"button",24),o(37,"Toggle right offcanvas"),r(),a(38,"div",25)(39,"div",26)(40,"h5",27),o(41,"Edit"),r(),p(42,"button",28),r(),a(43,"div",29),p(44,"div",30),a(45,"div",31)(46,"button",32),b("click",function(){return i.removePageTemplate()}),p(47,"i",33),o(48," Remove Template"),r(),a(49,"div")(50,"button",34),o(51,"Close"),r(),a(52,"button",35),b("click",function(){return i.addOrUpdatePageForm()}),o(53,"Save"),r()()()()(),a(54,"div",36)(55,"div",37)(56,"h5",27),o(57,"Templates"),r(),p(58,"button",28),r(),a(59,"div",29)(60,"div",38)(61,"div",39),S(62,pe,2,2,"div",40,me),r()()()()),t&2&&(c(18),x(i.builderPage),c(2),D(i.builderPage.length==0?20:-1),c(42),x(i.templateJson))},styles:[".vaxa-builder-block[_ngcontent-%COMP%]{width:100%;height:100px;border-radius:5px;border:2px solid #9f9c9c;align-content:center}.vaxa-builder-block[_ngcontent-%COMP%]   .vaxa-builder-content[_ngcontent-%COMP%]{display:grid;font-size:15px;color:#f0f8ff;text-transform:uppercase}  .vaxa-builder{border:1px solid rgb(110,170,235);height:50px}  .vaxa-builder:focus{background:#6eaaeb;height:30px}  .selected{background-color:#000;color:#fff}"]});let l=s;return l})();var C=class{constructor(){this.id=0,this.keyName="",this.keyValue="",this.isActive=1}};var re=(()=>{let s=class s{constructor(e){this.apiService=e}list(e){return this.apiService.apiCall("post","metadata/list?pageId="+e)}get(e){return this.apiService.apiCall("get","metadata/"+e+"/edit")}addOrUpdate(e){var t="";return console.log(e),e.id==""||e.id==null?t="metadata/create":t="metadata/update",this.apiService.apiCall("post",t,e)}};s.\u0275fac=function(t){return new(t||s)(W($))},s.\u0275prov=A({token:s,factory:s.\u0275fac,providedIn:"root"});let l=s;return l})();var ge=(l,s)=>s.id,oe=l=>({"is-invalid":l});function be(l,s){if(l&1){let m=_();a(0,"tr")(1,"td",29),o(2),r(),a(3,"td",29),o(4),r(),a(5,"td")(6,"a",30),b("click",function(){let t=f(m).$implicit,i=T();return v(i.editMetaData(t.id))}),p(7,"i",31),r()()()}if(l&2){let m=s.$implicit;c(2),F(m.keyName),c(2),F(m.keyValue)}}function fe(l,s){if(l&1&&(a(0,"tr",14)(1,"td",32),o(2),r()()),l&2){let m=T();c(2),w("",m.listLoadingMessage," ")}}var De=(()=>{let s=class s{constructor(e,t,i){this.metaTagService=e,this.commonService=t,this.route=i,this.metaData=new C,this.metaDataArray=[],this.pageId=0,this.listLoadingMessage="No Data Found"}ngOnInit(){let e=this.route.snapshot.queryParamMap.get("pageId");e!=null&&(this.pageId=Number(e),this.metaDataList(this.pageId))}metaDataList(e){this.metaTagService.list(e).subscribe({next:t=>{t!=null?t.success&&t.response.length>0&&(this.metaDataArray=t.response):this.commonService.errorMessage(t.message)}})}getMetaData(e){this.metaTagService.get(e).subscribe({next:t=>{t!=null?t.success&&(this.metaData=t.response):this.commonService.errorMessage(t.message)}})}submitMetaData(){this.metaData.pageId=this.pageId,this.metaTagService.addOrUpdate(this.metaData).subscribe({next:e=>{e!=null?e.success&&(this.commonService.successMessage(e.message),this.metaData=new C,this.metaDataList(this.pageId)):this.commonService.errorMessage(e.message)}})}editMetaData(e){this.getMetaData(e)}};s.\u0275fac=function(t){return new(t||s)(g(re),g(P),g(V))},s.\u0275cmp=E({type:s,selectors:[["app-meta-tag"]],standalone:!0,features:[B],decls:52,vars:9,consts:[["f","ngForm"],["keyName","ngModel"],["keyValue","ngModel"],[1,"navbar","bg-body-tertiary","shadow-sm"],[1,"container-fluid"],["routerLink","/dashboard",1,"text-decoration-none"],[1,"text-muted","text-decoration-none"],[1,"container-fluid","mt-3"],[1,"row"],[1,"col-md-8"],[1,"list-table"],[1,"table","table-sm"],[1,"table-secondary"],["scope","row"],[1,"text-center"],[1,"col-md-4"],[1,"common-header"],[1,"card"],["novalidate","",3,"ngSubmit"],[1,"card-body"],[1,"row","g-2"],[1,"col-md-12"],["for","Key",1,"form-label"],[1,"text-danger"],["type","text","placeholder","Enter Meta tag key","id","keyName","name","keyName","required","",1,"form-control",3,"ngModelChange","ngModel","ngClass"],[1,"invalid-feedback"],["for","keyValue",1,"form-label"],["id","keyValue","rows","3","placeholder","Enter Meta Tag Value ","name","keyValue","required","",1,"form-control",3,"ngModelChange","ngModel","ngClass"],["type","submit",1,"btn","btn-sm","common-btn-width","mt-1",3,"click"],[1,"w-40"],["type","button",1,"btn","common-btn","me-1",3,"click"],[1,"bi","bi-pencil"],["colspan","8"]],template:function(t,i){if(t&1){let n=_();a(0,"nav",3)(1,"div",4)(2,"div")(3,"a",5),o(4,"Dashboard / "),r(),a(5,"a",6),o(6,"Meta Tag"),r()()()(),a(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"table",11)(12,"thead")(13,"tr",12)(14,"th"),o(15,"key"),r(),a(16,"th"),o(17,"value"),r(),a(18,"th",13),o(19,"Actions"),r()()(),a(20,"tbody"),S(21,be,8,2,"tr",null,ge),I(23,fe,3,1,"tr",14),r()()()(),a(24,"div",15)(25,"div",16),o(26," Edit "),r(),a(27,"div",17)(28,"form",18,0),b("ngSubmit",function(){f(n);let d=k(29);return v(d.form.valid)}),a(30,"div",19)(31,"div",20)(32,"div",21)(33,"label",22),o(34,"Key "),a(35,"span",23),o(36,"*"),r()(),a(37,"input",24,1),L("ngModelChange",function(d){return f(n),j(i.metaData.keyName,d)||(i.metaData.keyName=d),v(d)}),r(),a(39,"div",25),o(40," Valid Meta tag Name is required. "),r()(),a(41,"div",21)(42,"label",26),o(43,"Value "),a(44,"span",23),o(45,"*"),r()(),a(46,"textarea",27,2),L("ngModelChange",function(d){return f(n),j(i.metaData.keyValue,d)||(i.metaData.keyValue=d),v(d)}),r(),a(48,"div",25),o(49," Valid Meta Tag Discription is required. "),r()()(),a(50,"button",28),b("click",function(){return f(n),v(i.submitMetaData())}),o(51,"submit"),r()()()()()()()}if(t&2){let n=k(29),u=k(38),d=k(47);c(21),x(i.metaDataArray),c(2),D(i.metaDataArray.length==0?23:-1),c(14),H("ngModel",i.metaData.keyName),y("ngClass",R(5,oe,n.submitted&&u.errors)),c(9),H("ngModel",i.metaData.keyValue),y("ngClass",R(7,oe,n.submitted&&d.errors))}},dependencies:[te,Z,K,G,Q,ee,Y,X,z,U]});let l=s;return l})();export{Se as a,De as b};
